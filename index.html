<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>가계부</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="app-header">
      <h1 class="app-title">가계부</h1>
      <span id="header-month" class="header-month"></span>
    </header>

    <!-- Tab Navigation -->
    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="input">입력</button>
      <button class="tab-btn" data-tab="monthly">월별</button>
      <button class="tab-btn" data-tab="category">카테고리</button>
      <button class="tab-btn" data-tab="history">내역</button>
    </nav>

    <!-- Tab: 입력 -->
    <section class="tab-content active" id="tab-input">
      <form id="entry-form" class="card">
        <div class="form-group">
          <label>날짜</label>
          <input type="date" id="entry-date" required />
        </div>
        <div class="form-group">
          <label>구분</label>
          <div class="type-toggle">
            <button type="button" class="toggle-btn active" data-type="income">수입</button>
            <button type="button" class="toggle-btn" data-type="expense">지출</button>
          </div>
        </div>
        <div class="form-group">
          <label>카테고리</label>
          <select id="entry-category" required></select>
        </div>
        <div class="form-group">
          <label>금액</label>
          <div class="amount-input-wrap">
            <input type="number" id="entry-amount" placeholder="0" min="0" required />
            <span class="amount-unit">원</span>
          </div>
        </div>
        <div class="form-group">
          <label>메모</label>
          <input type="text" id="entry-memo" placeholder="선택 입력" maxlength="50" />
        </div>
        <button type="submit" class="btn-primary">저장</button>
      </form>

      <!-- Today's Summary -->
      <div class="card today-summary">
        <div class="summary-title">오늘 요약</div>
        <div class="summary-row">
          <span class="label-income">수입</span>
          <span id="today-income" class="amount-income">0원</span>
        </div>
        <div class="summary-row">
          <span class="label-expense">지출</span>
          <span id="today-expense" class="amount-expense">0원</span>
        </div>
      </div>
    </section>

    <!-- Tab: 월별 -->
    <section class="tab-content" id="tab-monthly">
      <div class="month-nav card">
        <button id="prev-month" class="nav-arrow">&#8249;</button>
        <span id="current-month-label" class="month-label"></span>
        <button id="next-month" class="nav-arrow">&#8250;</button>
      </div>

      <div class="card monthly-summary">
        <div class="summary-row big">
          <span class="label-income">총 수입</span>
          <span id="monthly-income" class="amount-income">0원</span>
        </div>
        <div class="summary-row big">
          <span class="label-expense">총 지출</span>
          <span id="monthly-expense" class="amount-expense">0원</span>
        </div>
        <div class="summary-divider"></div>
        <div class="summary-row big">
          <span>잔액</span>
          <span id="monthly-balance" class="amount-balance">0원</span>
        </div>
      </div>

      <!-- Income breakdown -->
      <div class="card">
        <div class="section-label">수입 내역</div>
        <div id="monthly-income-breakdown"></div>
      </div>

      <!-- Expense breakdown -->
      <div class="card">
        <div class="section-label">지출 내역</div>
        <div id="monthly-expense-breakdown"></div>
      </div>
    </section>

    <!-- Tab: 카테고리 -->
    <section class="tab-content" id="tab-category">
      <div class="month-nav card">
        <button id="cat-prev-month" class="nav-arrow">&#8249;</button>
        <span id="cat-month-label" class="month-label"></span>
        <button id="cat-next-month" class="nav-arrow">&#8250;</button>
      </div>

      <div class="category-type-tabs">
        <button class="cat-type-btn active" data-type="expense">지출</button>
        <button class="cat-type-btn" data-type="income">수입</button>
      </div>

      <div id="category-chart-wrap" class="card">
        <canvas id="category-chart"></canvas>
        <div id="category-legend"></div>
      </div>

      <div id="category-list" class="card"></div>
    </section>

    <!-- Tab: 내역 -->
    <section class="tab-content" id="tab-history">
      <div class="month-nav card">
        <button id="hist-prev-month" class="nav-arrow">&#8249;</button>
        <span id="hist-month-label" class="month-label"></span>
        <button id="hist-next-month" class="nav-arrow">&#8250;</button>
      </div>

      <div id="history-list"></div>
    </section>
  </div>

  <!-- Action Modal (수정 / 삭제 선택) -->
  <div id="action-overlay" class="modal-overlay hidden">
    <div class="modal-box">
      <p id="action-desc" class="action-desc"></p>
      <div class="modal-actions">
        <button id="action-edit-btn" class="btn-action-edit">수정</button>
        <button id="action-delete-btn" class="btn-danger">삭제</button>
      </div>
      <button id="action-cancel-btn" class="btn-cancel btn-full">취소</button>
    </div>
  </div>

  <!-- Delete Confirm Modal -->
  <div id="modal-overlay" class="modal-overlay hidden">
    <div class="modal-box">
      <p>이 항목을 삭제할까요?</p>
      <div class="modal-actions">
        <button id="modal-cancel" class="btn-cancel">취소</button>
        <button id="modal-confirm" class="btn-danger">삭제</button>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div id="edit-overlay" class="modal-overlay hidden">
    <div class="modal-box edit-modal-box">
      <div class="edit-modal-title">내역 수정</div>
      <form id="edit-form">
        <div class="form-group">
          <label>날짜</label>
          <input type="date" id="edit-date" required />
        </div>
        <div class="form-group">
          <label>구분</label>
          <div class="type-toggle">
            <button type="button" class="edit-toggle-btn active" data-type="income">수입</button>
            <button type="button" class="edit-toggle-btn" data-type="expense">지출</button>
          </div>
        </div>
        <div class="form-group">
          <label>카테고리</label>
          <select id="edit-category" required></select>
        </div>
        <div class="form-group">
          <label>금액</label>
          <div class="amount-input-wrap">
            <input type="number" id="edit-amount" placeholder="0" min="0" required />
            <span class="amount-unit">원</span>
          </div>
        </div>
        <div class="form-group">
          <label>메모</label>
          <input type="text" id="edit-memo" placeholder="선택 입력" maxlength="50" />
        </div>
        <div class="modal-actions">
          <button type="button" id="edit-cancel" class="btn-cancel">취소</button>
          <button type="submit" class="btn-action-edit">저장</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden"></div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script src="js/data.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
